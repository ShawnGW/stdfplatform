<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.vtest.it.stdfplatform.dao.mes.MesDao">
    <resultMap id="waferYieldMap" type="com.vtest.it.stdfplatform.pojo.mes.waferYieldBean">
        <result property="customCode" column="custom_code"/>
        <result property="device" column="device"/>
        <result property="lotId" column="lot_id"/>
        <result property="cpStep" column="cp_step"/>
        <result property="waferNo" column="wafer_no"/>
        <result property="siteId" column="site_id"/>
        <result property="softBinNo" column="soft_bin_no"/>
        <result property="binCount" column="bin_count"/>
        <result property="passFail" column="pass_fail"/>
    </resultMap>
    <resultMap id="customerAndDevice" type="com.vtest.it.stdfplatform.pojo.mes.CustomerCodeAndDeviceBean">
        <result property="customerCode" column="CustCode"/>
        <result property="device" column="CustPart"/>
        <result property="lot" column="Lot"/>
    </resultMap>
    <select id="getWaferIdBySlot" resultType="string" statementType="CALLABLE">
       {call WebMES.dbo.pro_getWaferid(#{lot,mode=IN,jdbcType=VARCHAR},#{slot,mode=IN,jdbcType=VARCHAR})}
    </select>
    <select id="getLotSlotConfig" statementType="CALLABLE" resultType="com.vtest.it.stdfplatform.pojo.mes.SlotAndSequenceConfigBean">
        {call WebMES.dbo.pro_getSlotAndSequence(#{lot,mode=IN,jdbcType=VARCHAR})}
    </select>
    <select id="getWaferConfigFromMes" statementType="CALLABLE" resultType="com.vtest.it.stdfplatform.pojo.mes.MesConfigBean">
        {call WebMES.dbo.pro_GetWaferInfo(#{waferId,mode=IN,jdbcType=VARCHAR},#{cpProcess,mode=IN,jdbcType=VARCHAR})}
    </select>
    <select id="getCustomerAndDeviceByLot" statementType="CALLABLE" resultMap="customerAndDevice">
        {call WebMES.dbo.pro_GetLotDeviceInfo(#{lot,mode=IN,jdbcType=VARCHAR})}
    </select>
    <select id="getCustomerAndDeviceByWaferAndCpStep" statementType="CALLABLE" resultMap="customerAndDevice">
        {call WebMES.dbo.pro_GetCustDeviceInfo(#{waferId,mode=IN,jdbcType=VARCHAR},#{cpStep,mode=IN,jdbcType=VARCHAR})}
    </select>
    <insert id="siteYieldToMes" statementType="CALLABLE">
        {call sp_Insert_SiteYield(#{infor, mode=IN,jdbcType=VARCHAR},#{flag,mode=OUT,jdbcType=VARCHAR})}
    </insert>
    <select id="getBinDescription" statementType="CALLABLE" resultType="String">
         {call pro_GetBinDescInfo(
          #{waferId,mode=IN,jdbcType=VARCHAR},#{cpProcess,mode =IN,jdbcType=VARCHAR}
        )}
    </select>
    <select id="getPreviousCpStep" statementType="CALLABLE">
        {call WebMES.dbo.pro_GetLaststep(#{waferId,mode=IN,jdbcType=VARCHAR},#{cpProcess,mode=IN,jdbcType=VARCHAR})}
    </select>
    <select id="getTestBase" statementType="CALLABLE">
        {call WebMES.dbo.pro_GetTestBase(#{waferId,mode=IN,jdbcType=VARCHAR},#{cpProcess,mode=IN,jdbcType=VARCHAR}))}
    </select>
</mapper>